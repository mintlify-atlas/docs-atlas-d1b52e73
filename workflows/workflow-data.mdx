---
title: Workflow Data
description: Learn how to structure workflow data and configure recipients
---

## Workflow Body Structure

The workflow body is a dictionary containing three main components:

1. **workflow** - The name of the workflow to trigger
2. **recipients** - List of recipients and their channel information
3. **data** - Template variables and dynamic content

```python
workflow_body = {
    "workflow": "workflow-name",
    "recipients": [...],
    "data": {...}
}
```

## Recipients Structure

Recipients is a list of user objects. Each recipient must have a `distinct_id` and optionally channel information.

### Basic Recipient

```python
"recipients": [
    {
        "distinct_id": "0f988f74-6982-41c5-8752-facb6911fb08"
    }
]
```

If channel details are set in the user profile, providing just the `distinct_id` is sufficient.

### Recipient with Channel Details

```python
"recipients": [
    {
        "distinct_id": "0f988f74-6982-41c5-8752-facb6911fb08",
        "$email": ["user@example.com"],
        "$sms": ["+919999999999"],
        "$whatsapp": ["+919999999999"]
    }
]
```

### Limiting Channels

You can restrict communication to specific channels using the `$channels` property:

```python
"recipients": [
    {
        "distinct_id": "user_123",
        "$channels": ["email", "sms"],  # Only use email and SMS
        "$email": ["user@example.com"],
        "$sms": ["+919999999999"],
        "$whatsapp": ["+919999999999"]  # This will be ignored
    }
]
```

## Supported Channels

### Email

```python
"$email": ["user@example.com"]
```

### SMS

```python
"$sms": ["+919999999999"]
```

### WhatsApp

```python
"$whatsapp": ["+919999999999"]
```

### Android Push

```python
# FCM (default)
"$androidpush": [
    {
        "token": "__android_push_fcm_token__",
        "provider": "fcm",
        "device_id": ""
    }
]

# Xiaomi
"$androidpush": [
    {
        "token": "__android_push_xiaomi_token__",
        "provider": "xiaomi",
        "device_id": ""
    }
]

# Oppo
"$androidpush": [
    {
        "token": "__android_push_oppo_token__",
        "provider": "oppo",
        "device_id": ""
    }
]
```

### iOS Push

```python
"$iospush": ["__iospush_token__"]
```

### Slack

```python
# DM user using email
"$slack": [
    {
        "email": "user@example.com",
        "access_token": "xoxb-XXXXXXXXXXXX"
    }
]

# DM user using Slack member ID
"$slack": [
    {
        "user_id": "U03XXXXXXXX",
        "access_token": "xoxb-XXXXXXXXXXXX"
    }
]

# Post to channel
"$slack": [
    {
        "channel_id": "C03XXXXXXXX",
        "access_token": "xoxb-XXXXXXXXXXXX"
    }
]

# Using incoming webhook
"$slack": [
    {
        "incoming_webhook": {
            "url": "https://hooks.slack.com/services/TXXXXXXXXX/BXXXXXX/XXXXXXX"
        }
    }
]
```

### Microsoft Teams

```python
# DM on Teams channel using conversation ID
"$ms_teams": [
    {
        "tenant_id": "XXXXXXX",
        "service_url": "https://smba.trafficmanager.net/XXXXXXXXXX",
        "conversation_id": "XXXXXXXXXXXX"
    }
]

# DM user using Teams user ID
"$ms_teams": [
    {
        "tenant_id": "XXXXXXX",
        "service_url": "https://smba.trafficmanager.net/XXXXXXXXXX",
        "user_id": "XXXXXXXXXXXX"
    }
]

# Using incoming webhook
"$ms_teams": [
    {
        "incoming_webhook": {
            "url": "https://XXXXX.webhook.office.com/webhookb2/XXXXXXXXXX@XXXXXXXXXX/IncomingWebhook/XXXXXXXXXX/XXXXXXXXXX"
        }
    }
]
```

## Data Structure

The `data` object contains template variables that will be used in your workflow templates. It can be any JSON-serializable Python dictionary.

### Simple Data

```python
"data": {
    "first_name": "User",
    "spend_amount": "$10",
    "order_id": "ORD-12345"
}
```

### Nested Data

```python
"data": {
    "first_name": "User",
    "spend_amount": "$10",
    "nested_key_example": {
        "nested_key1": "some_value_1",
        "nested_key2": {
            "nested_key3": "some_value_3"
        }
    }
}
```

### Arrays in Data

```python
"data": {
    "user_name": "John Doe",
    "items": [
        {"name": "Product 1", "price": 100},
        {"name": "Product 2", "price": 200}
    ],
    "categories": ["electronics", "gadgets"]
}
```

## Complete Example

Here's a complete example combining all elements:

```python
from suprsend import Suprsend, WorkflowTriggerRequest

supr_client = Suprsend("workspace_key", "workspace_secret")

wf = WorkflowTriggerRequest(
    body={
        "workflow": "purchase-made",
        "recipients": [
            {
                "distinct_id": "0f988f74-6982-41c5-8752-facb6911fb08",
                "$channels": ["email", "sms"],
                "$email": ["user@example.com"],
                "$sms": ["+919999999999"],
                "$androidpush": [
                    {
                        "token": "__android_push_token__",
                        "provider": "fcm",
                        "device_id": ""
                    }
                ]
            }
        ],
        "data": {
            "first_name": "User",
            "spend_amount": "$10",
            "order_details": {
                "order_id": "ORD-12345",
                "items_count": 3,
                "delivery_date": "2024-02-15"
            }
        }
    },
    idempotency_key="purchase_0f988f74_12345",
    tenant_id="default"
)

response = supr_client.workflows.trigger(wf)
print(response)
```

## Best Practices

<Check>
- Use `distinct_id` consistently across your application
- Set channel details in user profiles to simplify workflow triggers
- Use `$channels` to control which channels are used for specific workflows
- Structure your data object to match your template variables
- Keep workflow body size under 800KB
</Check>

## Next Steps

<CardGroup cols={2}>
  <Card title="Attachments" icon="paperclip" href="/workflows/attachments">
    Add file attachments to workflows
  </Card>
  <Card title="Bulk Workflows" icon="layer-group" href="/workflows/bulk-workflows">
    Trigger multiple workflows efficiently
  </Card>
</CardGroup>